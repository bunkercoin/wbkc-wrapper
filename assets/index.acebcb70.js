const f=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function n(e){if(e.ep)return;e.ep=!0;const t=r(e);fetch(e.href,t)}};f();const o={polygonAddressRegex:/^[0][x][0-9a-zA-Z]{40}$/,bunkercoinAddressRegex:/^[B][a-zA-Z0-9]{33}$/,minDeposit:1e4,apiURL:"http://62.155.193.51:5000",explorerURL:"https://explorer.bunkercoin.xyz"},d=window.ethereum,p=async()=>{const s=new Web3Eth(d);if(s!==void 0){if(await s.net.getId()==137)return[void 0,!0];{const r=[{chainId:"0x89",chainName:"Matic Mainnet",nativeCurrency:{name:"MATIC",symbol:"MATIC",decimals:18},rpcUrls:["https://polygon-rpc.com/"],blockExplorerUrls:["https://polygonscan.com/"]}];return d.request({method:"wallet_addEthereumChain",params:r}).then(()=>[void 0,!0]).catch(n=>[n.message,!1])}}else return["Unable to locate MetaMask",!1]},y=document.querySelector("#button-add-to-metamask");y.addEventListener("click",async()=>{const[s,i]=await p();s&&!i&&alert(s),await d.enable().catch(a=>{alert(`An error has occured while enabling MetaMask: ${a}`)});const r=Web3Utils.toChecksumAddress(d.selectedAddress);document.querySelector("#matic-address").innerText=r,document.querySelector("#noMetamask").style.display="none",document.querySelector("#onceMetamask").style.display="block";const n=await(await fetch(`${o.apiURL}/getDepositAddress/${r}`)).json(),e=JSON.parse(n.message),{node:t,signature:c}=n,u=await(await fetch(`${o.explorerURL}/?action=verify&verify_address=${t}&verify_signature=${c}&verify_message=${n.message}`)).json();if(u.success&&u.result===!1){alert("The signature is invalid.");return}document.querySelector("#wrap-deposit-address").innerText=e.depositAddress;const l=(await(await fetch(`${o.apiURL}/getBalance/${r}`)).text()).slice(1).slice(0,-1);l!==document.querySelector("#wrap-confirmed").innerText&&(document.querySelector("#wrap-confirmed").innerText=l,parseFloat(l)>o.minDeposit&&(document.querySelector("#button-emit").style.display="block")),setInterval(async()=>{const a=(await(await fetch(`${o.apiURL}/getBalance/${r}`)).text()).slice(1).slice(0,-1);a!==document.querySelector("#wrap-confirmed").innerText&&(document.querySelector("#wrap-confirmed").innerText=a,parseFloat(a)>o.minDeposit&&(document.querySelector("#button-emit").style.display="block"));const m=(await(await fetch(`${o.apiURL}/getBalanceUnconfirmed/${r}`)).text()).slice(1).slice(0,-1);m!==document.querySelector("#wrap-unconfirmed").innerText&&(document.querySelector("#wrap-unconfirmed").innerText=m)},300*1e3),document.querySelector("#button-emit").addEventListener("click",async()=>{const a=await(await fetch(`${o.apiURL}/emitwBKC/${r}`)).json();console.log(a)})});
